// Sub Expressions
float S0 = q0*vn;
float S1 = q3*ve;
float S2 = q2*vd;
float S3 = S0 + S1 - S2;
float S4 = 2*S3;
float S5 = q1*vn + q2*ve + q3*vd;
float S6 = 2*S5;
float S7 = q1*ve;
float S8 = q0*vd;
float S9 = q2*vn;
float S10 = q0*ve;
float S11 = q1*vd;
float S12 = q3*vn;
float S13 = S10 + S11 - S12;
float S14 = 2*S13;
float S15 = powf(q1, 2);
float S16 = powf(q2, 2);
float S17 = -S16;
float S18 = powf(q0, 2);
float S19 = powf(q3, 2);
float S20 = S18 - S19;
float S21 = S15 + S17 + S20;
float S22 = q0*q3;
float S23 = q1*q2;
float S24 = S22 + S23;
float S25 = q1*q3;
float S26 = q0*q2;
float S27 = 2*S24;
float S28 = -2*S25 + 2*S26;
float S29 = 2*S5;
float S30 = 2*S3;
float S31 = -S7 + S8 + S9;
float S32 = 2*S31;
float S33 = P(0,2)*S32;
float S34 = 2*S13;
float S35 = P(0,3)*S34;
float S36 = P(0,0)*S30 + P(0,1)*S29 + P(0,4)*S21 + P(0,5)*S27 - P(0,6)*S28 - S33 + S35;
float S37 = P(0,5)*S30 + P(1,5)*S29 - P(2,5)*S32 + P(3,5)*S34 + P(4,5)*S21 + P(5,5)*S27 - P(5,6)*S28;
float S38 = P(0,6)*S30 + P(1,6)*S29 - P(2,6)*S32 + P(3,6)*S34 + P(4,6)*S21 + P(5,6)*S27 - P(6,6)*S28;
float S39 = P(1,2)*S32;
float S40 = P(1,3)*S34;
float S41 = P(0,1)*S30 + P(1,1)*S29 + P(1,4)*S21 + P(1,5)*S27 - P(1,6)*S28 - S39 + S40;
float S42 = P(1,2)*S29;
float S43 = P(0,2)*S30;
float S44 = -P(2,2)*S32 + P(2,3)*S34 + P(2,4)*S21 + P(2,5)*S27 - P(2,6)*S28 + S42 + S43;
float S45 = P(1,3)*S29;
float S46 = P(0,3)*S30;
float S47 = -P(2,3)*S32 + P(3,3)*S34 + P(3,4)*S21 + P(3,5)*S27 - P(3,6)*S28 + S45 + S46;
float S48 = P(0,4)*S30 + P(1,4)*S29 - P(2,4)*S32 + P(3,4)*S34 + P(4,4)*S21 + P(4,5)*S27 - P(4,6)*S28;
float S49 = 1.0F/(R_VEL + S21*S48 + S27*S37 - S28*S38 + S29*S41 + S30*S36 - S32*S44 + S34*S47);
float S50 = 2*S31;
float S51 = -S15;
float S52 = S16 + S20 + S51;
float S53 = q0*q1;
float S54 = q2*q3;
float S55 = S53 + S54;
float S56 = 2*S55;
float S57 = 2*S22 - 2*S23;
float S58 = P(0,1)*S32;
float S59 = P(0,0)*S34 + P(0,2)*S29 - P(0,4)*S57 + P(0,5)*S52 + P(0,6)*S56 - S46 + S58;
float S60 = P(0,6)*S34 + P(1,6)*S32 + P(2,6)*S29 - P(3,6)*S30 - P(4,6)*S57 + P(5,6)*S52 + P(6,6)*S56;
float S61 = P(0,4)*S34 + P(1,4)*S32 + P(2,4)*S29 - P(3,4)*S30 - P(4,4)*S57 + P(4,5)*S52 + P(4,6)*S56;
float S62 = P(2,3)*S30;
float S63 = P(0,2)*S34 + P(2,2)*S29 - P(2,4)*S57 + P(2,5)*S52 + P(2,6)*S56 + S39 - S62;
float S64 = P(0,1)*S34;
float S65 = P(1,1)*S32 - P(1,3)*S30 - P(1,4)*S57 + P(1,5)*S52 + P(1,6)*S56 + S42 + S64;
float S66 = P(2,3)*S29;
float S67 = P(1,3)*S32 - P(3,3)*S30 - P(3,4)*S57 + P(3,5)*S52 + P(3,6)*S56 + S35 + S66;
float S68 = P(0,5)*S34 + P(1,5)*S32 + P(2,5)*S29 - P(3,5)*S30 - P(4,5)*S57 + P(5,5)*S52 + P(5,6)*S56;
float S69 = 1.0F/(R_VEL + S29*S63 - S30*S67 + S32*S65 + S34*S59 + S52*S68 + S56*S60 - S57*S61);
float S70 = S25 + S26;
float S71 = S17 + S18 + S19 + S51;
float S72 = 2*S70;
float S73 = 2*S53 - 2*S54;
float S74 = P(0,0)*S32 + P(0,3)*S29 + P(0,4)*S72 - P(0,5)*S73 + P(0,6)*S71 + S43 - S64;
float S75 = P(0,4)*S32 - P(1,4)*S34 + P(2,4)*S30 + P(3,4)*S29 + P(4,4)*S72 - P(4,5)*S73 + P(4,6)*S71;
float S76 = P(0,5)*S32 - P(1,5)*S34 + P(2,5)*S30 + P(3,5)*S29 + P(4,5)*S72 - P(5,5)*S73 + P(5,6)*S71;
float S77 = P(0,3)*S32 + P(3,3)*S29 + P(3,4)*S72 - P(3,5)*S73 + P(3,6)*S71 - S40 + S62;
float S78 = -P(1,1)*S34 + P(1,2)*S30 + P(1,4)*S72 - P(1,5)*S73 + P(1,6)*S71 + S45 + S58;
float S79 = -P(1,2)*S34 + P(2,2)*S30 + P(2,4)*S72 - P(2,5)*S73 + P(2,6)*S71 + S33 + S66;
float S80 = P(0,6)*S32 - P(1,6)*S34 + P(2,6)*S30 + P(3,6)*S29 + P(4,6)*S72 - P(5,6)*S73 + P(6,6)*S71;
float S81 = 1.0F/(R_VEL + S29*S77 + S30*S79 + S32*S74 - S34*S78 + S71*S80 + S72*S75 - S73*S76);


// X axis observation Jacobians and Kalman gains
H_VEL(0) = S4;
H_VEL(1) = S6;
H_VEL(2) = 2*S7 - 2*S8 - 2*S9;
H_VEL(3) = S14;
H_VEL(4) = S21;
H_VEL(5) = 2*S24;
H_VEL(6) = 2*S25 - 2*S26;
H_VEL(7) = 0;
H_VEL(8) = 0;
H_VEL(9) = 0;
H_VEL(10) = 0;
H_VEL(11) = 0;
H_VEL(12) = 0;
H_VEL(13) = 0;
H_VEL(14) = 0;
H_VEL(15) = 0;
H_VEL(16) = 0;
H_VEL(17) = 0;
H_VEL(18) = 0;
H_VEL(19) = 0;
H_VEL(20) = 0;
H_VEL(21) = 0;
H_VEL(22) = 0;
H_VEL(23) = 0;


Kfusion(0) = S36*S49;
Kfusion(1) = S41*S49;
Kfusion(2) = S44*S49;
Kfusion(3) = S47*S49;
Kfusion(4) = S48*S49;
Kfusion(5) = S37*S49;
Kfusion(6) = S38*S49;
Kfusion(7) = S49*(P(0,7)*S30 + P(1,7)*S29 - P(2,7)*S32 + P(3,7)*S34 + P(4,7)*S21 + P(5,7)*S27 - P(6,7)*S28);
Kfusion(8) = S49*(P(0,8)*S30 + P(1,8)*S29 - P(2,8)*S32 + P(3,8)*S34 + P(4,8)*S21 + P(5,8)*S27 - P(6,8)*S28);
Kfusion(9) = S49*(P(0,9)*S30 + P(1,9)*S29 - P(2,9)*S32 + P(3,9)*S34 + P(4,9)*S21 + P(5,9)*S27 - P(6,9)*S28);
Kfusion(10) = S49*(P(0,10)*S30 + P(1,10)*S29 - P(2,10)*S32 + P(3,10)*S34 + P(4,10)*S21 + P(5,10)*S27 - P(6,10)*S28);
Kfusion(11) = S49*(P(0,11)*S30 + P(1,11)*S29 - P(2,11)*S32 + P(3,11)*S34 + P(4,11)*S21 + P(5,11)*S27 - P(6,11)*S28);
Kfusion(12) = S49*(P(0,12)*S30 + P(1,12)*S29 - P(2,12)*S32 + P(3,12)*S34 + P(4,12)*S21 + P(5,12)*S27 - P(6,12)*S28);
Kfusion(13) = S49*(P(0,13)*S30 + P(1,13)*S29 - P(2,13)*S32 + P(3,13)*S34 + P(4,13)*S21 + P(5,13)*S27 - P(6,13)*S28);
Kfusion(14) = S49*(P(0,14)*S30 + P(1,14)*S29 - P(2,14)*S32 + P(3,14)*S34 + P(4,14)*S21 + P(5,14)*S27 - P(6,14)*S28);
Kfusion(15) = S49*(P(0,15)*S30 + P(1,15)*S29 - P(2,15)*S32 + P(3,15)*S34 + P(4,15)*S21 + P(5,15)*S27 - P(6,15)*S28);
Kfusion(16) = S49*(P(0,16)*S30 + P(1,16)*S29 - P(2,16)*S32 + P(3,16)*S34 + P(4,16)*S21 + P(5,16)*S27 - P(6,16)*S28);
Kfusion(17) = S49*(P(0,17)*S30 + P(1,17)*S29 - P(2,17)*S32 + P(3,17)*S34 + P(4,17)*S21 + P(5,17)*S27 - P(6,17)*S28);
Kfusion(18) = S49*(P(0,18)*S30 + P(1,18)*S29 - P(2,18)*S32 + P(3,18)*S34 + P(4,18)*S21 + P(5,18)*S27 - P(6,18)*S28);
Kfusion(19) = S49*(P(0,19)*S30 + P(1,19)*S29 - P(2,19)*S32 + P(3,19)*S34 + P(4,19)*S21 + P(5,19)*S27 - P(6,19)*S28);
Kfusion(20) = S49*(P(0,20)*S30 + P(1,20)*S29 - P(2,20)*S32 + P(3,20)*S34 + P(4,20)*S21 + P(5,20)*S27 - P(6,20)*S28);
Kfusion(21) = S49*(P(0,21)*S30 + P(1,21)*S29 - P(2,21)*S32 + P(3,21)*S34 + P(4,21)*S21 + P(5,21)*S27 - P(6,21)*S28);
Kfusion(22) = S49*(P(0,22)*S30 + P(1,22)*S29 - P(2,22)*S32 + P(3,22)*S34 + P(4,22)*S21 + P(5,22)*S27 - P(6,22)*S28);
Kfusion(23) = S49*(P(0,23)*S30 + P(1,23)*S29 - P(2,23)*S32 + P(3,23)*S34 + P(4,23)*S21 + P(5,23)*S27 - P(6,23)*S28);


// Y axis observation Jacobians and Kalman gains
H_VEL(0) = S14;
H_VEL(1) = S50;
H_VEL(2) = S6;
H_VEL(3) = -2*S0 - 2*S1 + 2*S2;
H_VEL(4) = -2*S22 + 2*S23;
H_VEL(5) = S52;
H_VEL(6) = 2*S55;
H_VEL(7) = 0;
H_VEL(8) = 0;
H_VEL(9) = 0;
H_VEL(10) = 0;
H_VEL(11) = 0;
H_VEL(12) = 0;
H_VEL(13) = 0;
H_VEL(14) = 0;
H_VEL(15) = 0;
H_VEL(16) = 0;
H_VEL(17) = 0;
H_VEL(18) = 0;
H_VEL(19) = 0;
H_VEL(20) = 0;
H_VEL(21) = 0;
H_VEL(22) = 0;
H_VEL(23) = 0;


Kfusion(0) = S59*S69;
Kfusion(1) = S65*S69;
Kfusion(2) = S63*S69;
Kfusion(3) = S67*S69;
Kfusion(4) = S61*S69;
Kfusion(5) = S68*S69;
Kfusion(6) = S60*S69;
Kfusion(7) = S69*(P(0,7)*S34 + P(1,7)*S32 + P(2,7)*S29 - P(3,7)*S30 - P(4,7)*S57 + P(5,7)*S52 + P(6,7)*S56);
Kfusion(8) = S69*(P(0,8)*S34 + P(1,8)*S32 + P(2,8)*S29 - P(3,8)*S30 - P(4,8)*S57 + P(5,8)*S52 + P(6,8)*S56);
Kfusion(9) = S69*(P(0,9)*S34 + P(1,9)*S32 + P(2,9)*S29 - P(3,9)*S30 - P(4,9)*S57 + P(5,9)*S52 + P(6,9)*S56);
Kfusion(10) = S69*(P(0,10)*S34 + P(1,10)*S32 + P(2,10)*S29 - P(3,10)*S30 - P(4,10)*S57 + P(5,10)*S52 + P(6,10)*S56);
Kfusion(11) = S69*(P(0,11)*S34 + P(1,11)*S32 + P(2,11)*S29 - P(3,11)*S30 - P(4,11)*S57 + P(5,11)*S52 + P(6,11)*S56);
Kfusion(12) = S69*(P(0,12)*S34 + P(1,12)*S32 + P(2,12)*S29 - P(3,12)*S30 - P(4,12)*S57 + P(5,12)*S52 + P(6,12)*S56);
Kfusion(13) = S69*(P(0,13)*S34 + P(1,13)*S32 + P(2,13)*S29 - P(3,13)*S30 - P(4,13)*S57 + P(5,13)*S52 + P(6,13)*S56);
Kfusion(14) = S69*(P(0,14)*S34 + P(1,14)*S32 + P(2,14)*S29 - P(3,14)*S30 - P(4,14)*S57 + P(5,14)*S52 + P(6,14)*S56);
Kfusion(15) = S69*(P(0,15)*S34 + P(1,15)*S32 + P(2,15)*S29 - P(3,15)*S30 - P(4,15)*S57 + P(5,15)*S52 + P(6,15)*S56);
Kfusion(16) = S69*(P(0,16)*S34 + P(1,16)*S32 + P(2,16)*S29 - P(3,16)*S30 - P(4,16)*S57 + P(5,16)*S52 + P(6,16)*S56);
Kfusion(17) = S69*(P(0,17)*S34 + P(1,17)*S32 + P(2,17)*S29 - P(3,17)*S30 - P(4,17)*S57 + P(5,17)*S52 + P(6,17)*S56);
Kfusion(18) = S69*(P(0,18)*S34 + P(1,18)*S32 + P(2,18)*S29 - P(3,18)*S30 - P(4,18)*S57 + P(5,18)*S52 + P(6,18)*S56);
Kfusion(19) = S69*(P(0,19)*S34 + P(1,19)*S32 + P(2,19)*S29 - P(3,19)*S30 - P(4,19)*S57 + P(5,19)*S52 + P(6,19)*S56);
Kfusion(20) = S69*(P(0,20)*S34 + P(1,20)*S32 + P(2,20)*S29 - P(3,20)*S30 - P(4,20)*S57 + P(5,20)*S52 + P(6,20)*S56);
Kfusion(21) = S69*(P(0,21)*S34 + P(1,21)*S32 + P(2,21)*S29 - P(3,21)*S30 - P(4,21)*S57 + P(5,21)*S52 + P(6,21)*S56);
Kfusion(22) = S69*(P(0,22)*S34 + P(1,22)*S32 + P(2,22)*S29 - P(3,22)*S30 - P(4,22)*S57 + P(5,22)*S52 + P(6,22)*S56);
Kfusion(23) = S69*(P(0,23)*S34 + P(1,23)*S32 + P(2,23)*S29 - P(3,23)*S30 - P(4,23)*S57 + P(5,23)*S52 + P(6,23)*S56);


// Z axis observation Jacobians and Kalman gains
H_VEL(0) = S50;
H_VEL(1) = -2*S10 - 2*S11 + 2*S12;
H_VEL(2) = S4;
H_VEL(3) = S6;
H_VEL(4) = 2*S70;
H_VEL(5) = -2*S53 + 2*S54;
H_VEL(6) = S71;
H_VEL(7) = 0;
H_VEL(8) = 0;
H_VEL(9) = 0;
H_VEL(10) = 0;
H_VEL(11) = 0;
H_VEL(12) = 0;
H_VEL(13) = 0;
H_VEL(14) = 0;
H_VEL(15) = 0;
H_VEL(16) = 0;
H_VEL(17) = 0;
H_VEL(18) = 0;
H_VEL(19) = 0;
H_VEL(20) = 0;
H_VEL(21) = 0;
H_VEL(22) = 0;
H_VEL(23) = 0;


Kfusion(0) = S74*S81;
Kfusion(1) = S78*S81;
Kfusion(2) = S79*S81;
Kfusion(3) = S77*S81;
Kfusion(4) = S75*S81;
Kfusion(5) = S76*S81;
Kfusion(6) = S80*S81;
Kfusion(7) = S81*(P(0,7)*S32 - P(1,7)*S34 + P(2,7)*S30 + P(3,7)*S29 + P(4,7)*S72 - P(5,7)*S73 + P(6,7)*S71);
Kfusion(8) = S81*(P(0,8)*S32 - P(1,8)*S34 + P(2,8)*S30 + P(3,8)*S29 + P(4,8)*S72 - P(5,8)*S73 + P(6,8)*S71);
Kfusion(9) = S81*(P(0,9)*S32 - P(1,9)*S34 + P(2,9)*S30 + P(3,9)*S29 + P(4,9)*S72 - P(5,9)*S73 + P(6,9)*S71);
Kfusion(10) = S81*(P(0,10)*S32 - P(1,10)*S34 + P(2,10)*S30 + P(3,10)*S29 + P(4,10)*S72 - P(5,10)*S73 + P(6,10)*S71);
Kfusion(11) = S81*(P(0,11)*S32 - P(1,11)*S34 + P(2,11)*S30 + P(3,11)*S29 + P(4,11)*S72 - P(5,11)*S73 + P(6,11)*S71);
Kfusion(12) = S81*(P(0,12)*S32 - P(1,12)*S34 + P(2,12)*S30 + P(3,12)*S29 + P(4,12)*S72 - P(5,12)*S73 + P(6,12)*S71);
Kfusion(13) = S81*(P(0,13)*S32 - P(1,13)*S34 + P(2,13)*S30 + P(3,13)*S29 + P(4,13)*S72 - P(5,13)*S73 + P(6,13)*S71);
Kfusion(14) = S81*(P(0,14)*S32 - P(1,14)*S34 + P(2,14)*S30 + P(3,14)*S29 + P(4,14)*S72 - P(5,14)*S73 + P(6,14)*S71);
Kfusion(15) = S81*(P(0,15)*S32 - P(1,15)*S34 + P(2,15)*S30 + P(3,15)*S29 + P(4,15)*S72 - P(5,15)*S73 + P(6,15)*S71);
Kfusion(16) = S81*(P(0,16)*S32 - P(1,16)*S34 + P(2,16)*S30 + P(3,16)*S29 + P(4,16)*S72 - P(5,16)*S73 + P(6,16)*S71);
Kfusion(17) = S81*(P(0,17)*S32 - P(1,17)*S34 + P(2,17)*S30 + P(3,17)*S29 + P(4,17)*S72 - P(5,17)*S73 + P(6,17)*S71);
Kfusion(18) = S81*(P(0,18)*S32 - P(1,18)*S34 + P(2,18)*S30 + P(3,18)*S29 + P(4,18)*S72 - P(5,18)*S73 + P(6,18)*S71);
Kfusion(19) = S81*(P(0,19)*S32 - P(1,19)*S34 + P(2,19)*S30 + P(3,19)*S29 + P(4,19)*S72 - P(5,19)*S73 + P(6,19)*S71);
Kfusion(20) = S81*(P(0,20)*S32 - P(1,20)*S34 + P(2,20)*S30 + P(3,20)*S29 + P(4,20)*S72 - P(5,20)*S73 + P(6,20)*S71);
Kfusion(21) = S81*(P(0,21)*S32 - P(1,21)*S34 + P(2,21)*S30 + P(3,21)*S29 + P(4,21)*S72 - P(5,21)*S73 + P(6,21)*S71);
Kfusion(22) = S81*(P(0,22)*S32 - P(1,22)*S34 + P(2,22)*S30 + P(3,22)*S29 + P(4,22)*S72 - P(5,22)*S73 + P(6,22)*S71);
Kfusion(23) = S81*(P(0,23)*S32 - P(1,23)*S34 + P(2,23)*S30 + P(3,23)*S29 + P(4,23)*S72 - P(5,23)*S73 + P(6,23)*S71);


