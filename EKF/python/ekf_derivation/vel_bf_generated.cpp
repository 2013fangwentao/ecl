// axis 0
float S0 = q0*vn - q2*vd + q3*ve;
float S1 = q1*vn + q2*ve + q3*vd;
float S2 = q1*ve;
float S3 = q0*vd;
float S4 = q2*vn;
float S5 = q0*ve + q1*vd - q3*vn;
float S6 = powf(q0, 2) + powf(q1, 2) - powf(q2, 2) - powf(q3, 2);
float S7 = q0*q3 + q1*q2;
float S8 = q1*q3;
float S9 = q0*q2;
float S10 = 2*S7;
float S11 = -2*S8 + 2*S9;
float S12 = 2*S1;
float S13 = 2*S0;
float S14 = -2*S2 + 2*S3 + 2*S4;
float S15 = 2*S5;
float S16 = P(0,0)*S13 + P(0,1)*S12 - P(0,2)*S14 + P(0,3)*S15 + P(0,4)*S6 + P(0,5)*S10 - P(0,6)*S11;
float S17 = P(0,5)*S13 + P(1,5)*S12 - P(2,5)*S14 + P(3,5)*S15 + P(4,5)*S6 + P(5,5)*S10 - P(5,6)*S11;
float S18 = P(0,6)*S13 + P(1,6)*S12 - P(2,6)*S14 + P(3,6)*S15 + P(4,6)*S6 + P(5,6)*S10 - P(6,6)*S11;
float S19 = P(0,1)*S13 + P(1,1)*S12 - P(1,2)*S14 + P(1,3)*S15 + P(1,4)*S6 + P(1,5)*S10 - P(1,6)*S11;
float S20 = P(0,2)*S13 + P(1,2)*S12 - P(2,2)*S14 + P(2,3)*S15 + P(2,4)*S6 + P(2,5)*S10 - P(2,6)*S11;
float S21 = P(0,3)*S13 + P(1,3)*S12 - P(2,3)*S14 + P(3,3)*S15 + P(3,4)*S6 + P(3,5)*S10 - P(3,6)*S11;
float S22 = P(0,4)*S13 + P(1,4)*S12 - P(2,4)*S14 + P(3,4)*S15 + P(4,4)*S6 + P(4,5)*S10 - P(4,6)*S11;
float S23 = 1.0F/(R_VEL + S10*S17 - S11*S18 + S12*S19 + S13*S16 - S14*S20 + S15*S21 + S22*S6);


H_VEL(0) = 2*S0;
H_VEL(1) = 2*S1;
H_VEL(2) = 2*S2 - 2*S3 - 2*S4;
H_VEL(3) = 2*S5;
H_VEL(4) = S6;
H_VEL(5) = 2*S7;
H_VEL(6) = 2*S8 - 2*S9;
H_VEL(7) = 0;
H_VEL(8) = 0;
H_VEL(9) = 0;
H_VEL(10) = 0;
H_VEL(11) = 0;
H_VEL(12) = 0;
H_VEL(13) = 0;
H_VEL(14) = 0;
H_VEL(15) = 0;
H_VEL(16) = 0;
H_VEL(17) = 0;
H_VEL(18) = 0;
H_VEL(19) = 0;
H_VEL(20) = 0;
H_VEL(21) = 0;
H_VEL(22) = 0;
H_VEL(23) = 0;


Kfusion(0) = S16*S23;
Kfusion(1) = S19*S23;
Kfusion(2) = S20*S23;
Kfusion(3) = S21*S23;
Kfusion(4) = S22*S23;
Kfusion(5) = S17*S23;
Kfusion(6) = S18*S23;
Kfusion(7) = S23*(P(0,7)*S13 + P(1,7)*S12 - P(2,7)*S14 + P(3,7)*S15 + P(4,7)*S6 + P(5,7)*S10 - P(6,7)*S11);
Kfusion(8) = S23*(P(0,8)*S13 + P(1,8)*S12 - P(2,8)*S14 + P(3,8)*S15 + P(4,8)*S6 + P(5,8)*S10 - P(6,8)*S11);
Kfusion(9) = S23*(P(0,9)*S13 + P(1,9)*S12 - P(2,9)*S14 + P(3,9)*S15 + P(4,9)*S6 + P(5,9)*S10 - P(6,9)*S11);
Kfusion(10) = S23*(P(0,10)*S13 + P(1,10)*S12 - P(2,10)*S14 + P(3,10)*S15 + P(4,10)*S6 + P(5,10)*S10 - P(6,10)*S11);
Kfusion(11) = S23*(P(0,11)*S13 + P(1,11)*S12 - P(2,11)*S14 + P(3,11)*S15 + P(4,11)*S6 + P(5,11)*S10 - P(6,11)*S11);
Kfusion(12) = S23*(P(0,12)*S13 + P(1,12)*S12 - P(2,12)*S14 + P(3,12)*S15 + P(4,12)*S6 + P(5,12)*S10 - P(6,12)*S11);
Kfusion(13) = S23*(P(0,13)*S13 + P(1,13)*S12 - P(2,13)*S14 + P(3,13)*S15 + P(4,13)*S6 + P(5,13)*S10 - P(6,13)*S11);
Kfusion(14) = S23*(P(0,14)*S13 + P(1,14)*S12 - P(2,14)*S14 + P(3,14)*S15 + P(4,14)*S6 + P(5,14)*S10 - P(6,14)*S11);
Kfusion(15) = S23*(P(0,15)*S13 + P(1,15)*S12 - P(2,15)*S14 + P(3,15)*S15 + P(4,15)*S6 + P(5,15)*S10 - P(6,15)*S11);
Kfusion(16) = S23*(P(0,16)*S13 + P(1,16)*S12 - P(2,16)*S14 + P(3,16)*S15 + P(4,16)*S6 + P(5,16)*S10 - P(6,16)*S11);
Kfusion(17) = S23*(P(0,17)*S13 + P(1,17)*S12 - P(2,17)*S14 + P(3,17)*S15 + P(4,17)*S6 + P(5,17)*S10 - P(6,17)*S11);
Kfusion(18) = S23*(P(0,18)*S13 + P(1,18)*S12 - P(2,18)*S14 + P(3,18)*S15 + P(4,18)*S6 + P(5,18)*S10 - P(6,18)*S11);
Kfusion(19) = S23*(P(0,19)*S13 + P(1,19)*S12 - P(2,19)*S14 + P(3,19)*S15 + P(4,19)*S6 + P(5,19)*S10 - P(6,19)*S11);
Kfusion(20) = S23*(P(0,20)*S13 + P(1,20)*S12 - P(2,20)*S14 + P(3,20)*S15 + P(4,20)*S6 + P(5,20)*S10 - P(6,20)*S11);
Kfusion(21) = S23*(P(0,21)*S13 + P(1,21)*S12 - P(2,21)*S14 + P(3,21)*S15 + P(4,21)*S6 + P(5,21)*S10 - P(6,21)*S11);
Kfusion(22) = S23*(P(0,22)*S13 + P(1,22)*S12 - P(2,22)*S14 + P(3,22)*S15 + P(4,22)*S6 + P(5,22)*S10 - P(6,22)*S11);
Kfusion(23) = S23*(P(0,23)*S13 + P(1,23)*S12 - P(2,23)*S14 + P(3,23)*S15 + P(4,23)*S6 + P(5,23)*S10 - P(6,23)*S11);


// axis 1
float S0 = q0*ve + q1*vd - q3*vn;
float S1 = q0*vd - q1*ve + q2*vn;
float S2 = q1*vn + q2*ve + q3*vd;
float S3 = q2*vd;
float S4 = q0*vn;
float S5 = q3*ve;
float S6 = q1*q2;
float S7 = q0*q3;
float S8 = powf(q0, 2) - powf(q1, 2) + powf(q2, 2) - powf(q3, 2);
float S9 = q0*q1 + q2*q3;
float S10 = 2*S9;
float S11 = -2*S6 + 2*S7;
float S12 = 2*S2;
float S13 = 2*S0;
float S14 = 2*S1;
float S15 = -2*S3 + 2*S4 + 2*S5;
float S16 = P(0,0)*S13 + P(0,1)*S14 + P(0,2)*S12 - P(0,3)*S15 - P(0,4)*S11 + P(0,5)*S8 + P(0,6)*S10;
float S17 = P(0,6)*S13 + P(1,6)*S14 + P(2,6)*S12 - P(3,6)*S15 - P(4,6)*S11 + P(5,6)*S8 + P(6,6)*S10;
float S18 = P(0,4)*S13 + P(1,4)*S14 + P(2,4)*S12 - P(3,4)*S15 - P(4,4)*S11 + P(4,5)*S8 + P(4,6)*S10;
float S19 = P(0,2)*S13 + P(1,2)*S14 + P(2,2)*S12 - P(2,3)*S15 - P(2,4)*S11 + P(2,5)*S8 + P(2,6)*S10;
float S20 = P(0,1)*S13 + P(1,1)*S14 + P(1,2)*S12 - P(1,3)*S15 - P(1,4)*S11 + P(1,5)*S8 + P(1,6)*S10;
float S21 = P(0,3)*S13 + P(1,3)*S14 + P(2,3)*S12 - P(3,3)*S15 - P(3,4)*S11 + P(3,5)*S8 + P(3,6)*S10;
float S22 = P(0,5)*S13 + P(1,5)*S14 + P(2,5)*S12 - P(3,5)*S15 - P(4,5)*S11 + P(5,5)*S8 + P(5,6)*S10;
float S23 = 1.0F/(R_VEL + S10*S17 - S11*S18 + S12*S19 + S13*S16 + S14*S20 - S15*S21 + S22*S8);


H_VEL(0) = 2*S0;
H_VEL(1) = 2*S1;
H_VEL(2) = 2*S2;
H_VEL(3) = 2*S3 - 2*S4 - 2*S5;
H_VEL(4) = 2*S6 - 2*S7;
H_VEL(5) = S8;
H_VEL(6) = 2*S9;
H_VEL(7) = 0;
H_VEL(8) = 0;
H_VEL(9) = 0;
H_VEL(10) = 0;
H_VEL(11) = 0;
H_VEL(12) = 0;
H_VEL(13) = 0;
H_VEL(14) = 0;
H_VEL(15) = 0;
H_VEL(16) = 0;
H_VEL(17) = 0;
H_VEL(18) = 0;
H_VEL(19) = 0;
H_VEL(20) = 0;
H_VEL(21) = 0;
H_VEL(22) = 0;
H_VEL(23) = 0;


Kfusion(0) = S16*S23;
Kfusion(1) = S20*S23;
Kfusion(2) = S19*S23;
Kfusion(3) = S21*S23;
Kfusion(4) = S18*S23;
Kfusion(5) = S22*S23;
Kfusion(6) = S17*S23;
Kfusion(7) = S23*(P(0,7)*S13 + P(1,7)*S14 + P(2,7)*S12 - P(3,7)*S15 - P(4,7)*S11 + P(5,7)*S8 + P(6,7)*S10);
Kfusion(8) = S23*(P(0,8)*S13 + P(1,8)*S14 + P(2,8)*S12 - P(3,8)*S15 - P(4,8)*S11 + P(5,8)*S8 + P(6,8)*S10);
Kfusion(9) = S23*(P(0,9)*S13 + P(1,9)*S14 + P(2,9)*S12 - P(3,9)*S15 - P(4,9)*S11 + P(5,9)*S8 + P(6,9)*S10);
Kfusion(10) = S23*(P(0,10)*S13 + P(1,10)*S14 + P(2,10)*S12 - P(3,10)*S15 - P(4,10)*S11 + P(5,10)*S8 + P(6,10)*S10);
Kfusion(11) = S23*(P(0,11)*S13 + P(1,11)*S14 + P(2,11)*S12 - P(3,11)*S15 - P(4,11)*S11 + P(5,11)*S8 + P(6,11)*S10);
Kfusion(12) = S23*(P(0,12)*S13 + P(1,12)*S14 + P(2,12)*S12 - P(3,12)*S15 - P(4,12)*S11 + P(5,12)*S8 + P(6,12)*S10);
Kfusion(13) = S23*(P(0,13)*S13 + P(1,13)*S14 + P(2,13)*S12 - P(3,13)*S15 - P(4,13)*S11 + P(5,13)*S8 + P(6,13)*S10);
Kfusion(14) = S23*(P(0,14)*S13 + P(1,14)*S14 + P(2,14)*S12 - P(3,14)*S15 - P(4,14)*S11 + P(5,14)*S8 + P(6,14)*S10);
Kfusion(15) = S23*(P(0,15)*S13 + P(1,15)*S14 + P(2,15)*S12 - P(3,15)*S15 - P(4,15)*S11 + P(5,15)*S8 + P(6,15)*S10);
Kfusion(16) = S23*(P(0,16)*S13 + P(1,16)*S14 + P(2,16)*S12 - P(3,16)*S15 - P(4,16)*S11 + P(5,16)*S8 + P(6,16)*S10);
Kfusion(17) = S23*(P(0,17)*S13 + P(1,17)*S14 + P(2,17)*S12 - P(3,17)*S15 - P(4,17)*S11 + P(5,17)*S8 + P(6,17)*S10);
Kfusion(18) = S23*(P(0,18)*S13 + P(1,18)*S14 + P(2,18)*S12 - P(3,18)*S15 - P(4,18)*S11 + P(5,18)*S8 + P(6,18)*S10);
Kfusion(19) = S23*(P(0,19)*S13 + P(1,19)*S14 + P(2,19)*S12 - P(3,19)*S15 - P(4,19)*S11 + P(5,19)*S8 + P(6,19)*S10);
Kfusion(20) = S23*(P(0,20)*S13 + P(1,20)*S14 + P(2,20)*S12 - P(3,20)*S15 - P(4,20)*S11 + P(5,20)*S8 + P(6,20)*S10);
Kfusion(21) = S23*(P(0,21)*S13 + P(1,21)*S14 + P(2,21)*S12 - P(3,21)*S15 - P(4,21)*S11 + P(5,21)*S8 + P(6,21)*S10);
Kfusion(22) = S23*(P(0,22)*S13 + P(1,22)*S14 + P(2,22)*S12 - P(3,22)*S15 - P(4,22)*S11 + P(5,22)*S8 + P(6,22)*S10);
Kfusion(23) = S23*(P(0,23)*S13 + P(1,23)*S14 + P(2,23)*S12 - P(3,23)*S15 - P(4,23)*S11 + P(5,23)*S8 + P(6,23)*S10);


// axis 2
float S0 = q0*vd - q1*ve + q2*vn;
float S1 = q3*vn;
float S2 = q0*ve;
float S3 = q1*vd;
float S4 = q0*vn - q2*vd + q3*ve;
float S5 = q1*vn + q2*ve + q3*vd;
float S6 = q0*q2 + q1*q3;
float S7 = q2*q3;
float S8 = q0*q1;
float S9 = powf(q0, 2) - powf(q1, 2) - powf(q2, 2) + powf(q3, 2);
float S10 = 2*S6;
float S11 = -2*S7 + 2*S8;
float S12 = 2*S5;
float S13 = 2*S0;
float S14 = -2*S1 + 2*S2 + 2*S3;
float S15 = 2*S4;
float S16 = P(0,0)*S13 - P(0,1)*S14 + P(0,2)*S15 + P(0,3)*S12 + P(0,4)*S10 - P(0,5)*S11 + P(0,6)*S9;
float S17 = P(0,4)*S13 - P(1,4)*S14 + P(2,4)*S15 + P(3,4)*S12 + P(4,4)*S10 - P(4,5)*S11 + P(4,6)*S9;
float S18 = P(0,5)*S13 - P(1,5)*S14 + P(2,5)*S15 + P(3,5)*S12 + P(4,5)*S10 - P(5,5)*S11 + P(5,6)*S9;
float S19 = P(0,3)*S13 - P(1,3)*S14 + P(2,3)*S15 + P(3,3)*S12 + P(3,4)*S10 - P(3,5)*S11 + P(3,6)*S9;
float S20 = P(0,1)*S13 - P(1,1)*S14 + P(1,2)*S15 + P(1,3)*S12 + P(1,4)*S10 - P(1,5)*S11 + P(1,6)*S9;
float S21 = P(0,2)*S13 - P(1,2)*S14 + P(2,2)*S15 + P(2,3)*S12 + P(2,4)*S10 - P(2,5)*S11 + P(2,6)*S9;
float S22 = P(0,6)*S13 - P(1,6)*S14 + P(2,6)*S15 + P(3,6)*S12 + P(4,6)*S10 - P(5,6)*S11 + P(6,6)*S9;
float S23 = 1.0F/(R_VEL + S10*S17 - S11*S18 + S12*S19 + S13*S16 - S14*S20 + S15*S21 + S22*S9);


H_VEL(0) = 2*S0;
H_VEL(1) = 2*S1 - 2*S2 - 2*S3;
H_VEL(2) = 2*S4;
H_VEL(3) = 2*S5;
H_VEL(4) = 2*S6;
H_VEL(5) = 2*S7 - 2*S8;
H_VEL(6) = S9;
H_VEL(7) = 0;
H_VEL(8) = 0;
H_VEL(9) = 0;
H_VEL(10) = 0;
H_VEL(11) = 0;
H_VEL(12) = 0;
H_VEL(13) = 0;
H_VEL(14) = 0;
H_VEL(15) = 0;
H_VEL(16) = 0;
H_VEL(17) = 0;
H_VEL(18) = 0;
H_VEL(19) = 0;
H_VEL(20) = 0;
H_VEL(21) = 0;
H_VEL(22) = 0;
H_VEL(23) = 0;


Kfusion(0) = S16*S23;
Kfusion(1) = S20*S23;
Kfusion(2) = S21*S23;
Kfusion(3) = S19*S23;
Kfusion(4) = S17*S23;
Kfusion(5) = S18*S23;
Kfusion(6) = S22*S23;
Kfusion(7) = S23*(P(0,7)*S13 - P(1,7)*S14 + P(2,7)*S15 + P(3,7)*S12 + P(4,7)*S10 - P(5,7)*S11 + P(6,7)*S9);
Kfusion(8) = S23*(P(0,8)*S13 - P(1,8)*S14 + P(2,8)*S15 + P(3,8)*S12 + P(4,8)*S10 - P(5,8)*S11 + P(6,8)*S9);
Kfusion(9) = S23*(P(0,9)*S13 - P(1,9)*S14 + P(2,9)*S15 + P(3,9)*S12 + P(4,9)*S10 - P(5,9)*S11 + P(6,9)*S9);
Kfusion(10) = S23*(P(0,10)*S13 - P(1,10)*S14 + P(2,10)*S15 + P(3,10)*S12 + P(4,10)*S10 - P(5,10)*S11 + P(6,10)*S9);
Kfusion(11) = S23*(P(0,11)*S13 - P(1,11)*S14 + P(2,11)*S15 + P(3,11)*S12 + P(4,11)*S10 - P(5,11)*S11 + P(6,11)*S9);
Kfusion(12) = S23*(P(0,12)*S13 - P(1,12)*S14 + P(2,12)*S15 + P(3,12)*S12 + P(4,12)*S10 - P(5,12)*S11 + P(6,12)*S9);
Kfusion(13) = S23*(P(0,13)*S13 - P(1,13)*S14 + P(2,13)*S15 + P(3,13)*S12 + P(4,13)*S10 - P(5,13)*S11 + P(6,13)*S9);
Kfusion(14) = S23*(P(0,14)*S13 - P(1,14)*S14 + P(2,14)*S15 + P(3,14)*S12 + P(4,14)*S10 - P(5,14)*S11 + P(6,14)*S9);
Kfusion(15) = S23*(P(0,15)*S13 - P(1,15)*S14 + P(2,15)*S15 + P(3,15)*S12 + P(4,15)*S10 - P(5,15)*S11 + P(6,15)*S9);
Kfusion(16) = S23*(P(0,16)*S13 - P(1,16)*S14 + P(2,16)*S15 + P(3,16)*S12 + P(4,16)*S10 - P(5,16)*S11 + P(6,16)*S9);
Kfusion(17) = S23*(P(0,17)*S13 - P(1,17)*S14 + P(2,17)*S15 + P(3,17)*S12 + P(4,17)*S10 - P(5,17)*S11 + P(6,17)*S9);
Kfusion(18) = S23*(P(0,18)*S13 - P(1,18)*S14 + P(2,18)*S15 + P(3,18)*S12 + P(4,18)*S10 - P(5,18)*S11 + P(6,18)*S9);
Kfusion(19) = S23*(P(0,19)*S13 - P(1,19)*S14 + P(2,19)*S15 + P(3,19)*S12 + P(4,19)*S10 - P(5,19)*S11 + P(6,19)*S9);
Kfusion(20) = S23*(P(0,20)*S13 - P(1,20)*S14 + P(2,20)*S15 + P(3,20)*S12 + P(4,20)*S10 - P(5,20)*S11 + P(6,20)*S9);
Kfusion(21) = S23*(P(0,21)*S13 - P(1,21)*S14 + P(2,21)*S15 + P(3,21)*S12 + P(4,21)*S10 - P(5,21)*S11 + P(6,21)*S9);
Kfusion(22) = S23*(P(0,22)*S13 - P(1,22)*S14 + P(2,22)*S15 + P(3,22)*S12 + P(4,22)*S10 - P(5,22)*S11 + P(6,22)*S9);
Kfusion(23) = S23*(P(0,23)*S13 - P(1,23)*S14 + P(2,23)*S15 + P(3,23)*S12 + P(4,23)*S10 - P(5,23)*S11 + P(6,23)*S9);


